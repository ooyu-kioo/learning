9.1 意図を持ったテスト
***

9.2 受信メッセージをテストする
***

3章で使ったサンプルコードを元にテストを書いていく
```rb
class Wheel
  attr_reader :rim, :tire3
  
  def initialize(rim, tire)
    @rim = rim5
    @tire = tire6
  end
  
  def diameter
    rim + (tire * 2)
  end
  # ...
end

class Gear
  attr_reader :chainring, :cog, :rim, :tire
  
  def initialize(args)
    @chainring = args[:chainring]
    @cog = args[:cog]
    @rim = args[:rim]
    @tire = args[:tire]
  end
  
  def gear_inches
    ratio * Wheel.new(rim, tire).diameter
  end
  
  def ratio
    chainring / cog.to_f
  end
  # ...
end
```

簡単なテスト(miniTest)
```rb
class WheelTest < MiniTest::Unit::TestCase
  def test_calculates_diameter
    wheel = Wheel.new(26, 1.5)
    assert_in_delta(29, wheel.diameter, 0.01)
  end
end

class GearTest < MiniTest::Unit::TestCase
  def test_calculates_gear_inches
    gear = Gear.new(
      chainring: 52,
      cog: 11,
      rim: 26,
      tire: 1.5
    )
    assert_in_delta(137.1, gear.gear_inches, 0.01)
  end
end
```
この際、GearTestではGear.new時に無条件にWheelのinstanceを作成している
=> GearのtestでGearは正しいのにWheelによって失敗してしまう可能性がある
=> そもそもの設計に問題がある

## テスト対象のobjを隔離する

３章でのリファクタによって、Gearはmethod：diameterを実装したobjが
引数として渡ってくることを想定する形に変更
```rb
class Gear
  attr_reader :chainring, :cog, :wheel
  
  def initialize(args)
    @chainring = args[:chainring]
    @cog = args[:cog]
    @wheel = args[:wheel]
  end
  
  def gear_inches
    # 'wheel'変数内のオブジェクトが
    # 'Diameterizable' ロールを担う
    ratio * wheel.diameter
  end
  
  def ratio
    chainring / cog.to_f
  end
  # ...
end
```

これにより、testも依存なくかける
```rb
class GearTest < MiniTest::Unit::TestCase
  def test_calculates_gear_inches
    gear =  Gear.new(
      chainring: 52,
      cog: 11,
      wheel: Wheel.new(26, 1.5)
    )
    assert_in_delta(137.1, gear.gear_inches, 0.01)
  end
end
```

## テストダブル = フェイクobjを作る p385


9.3 プライベートメソッドのテスト
***

## テスト中ではプライベートメソッドを無視する
- objのインターフェースのテストを行う以上、そのテストで洗い出せる
- プライベートメソッドは変更が多いとこなのでメンテだるい


9.4 送信メッセージをテストする
***

